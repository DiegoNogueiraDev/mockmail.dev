#!/bin/bash
echo "=== VARREDURA COMPLETA DE MALWARE ==="

# Procurar processos de mineração
echo -e "\n[1] Processos suspeitos:"
ps aux | grep -iE "xmrig|stratum|minerd|cpuminer|defunct|syssls" | grep -v grep || echo "  ✓ Nenhum encontrado"

# Verificar cron
echo -e "\n[2] Cron jobs:"
crontab -l 2>/dev/null | grep -iE "base64|curl.*sh|wget.*sh|defunct" && echo "  ✗ SUSPEITO!" || echo "  ✓ Limpo"

# Verificar shell configs
echo -e "\n[3] Arquivos de configuração:"
grep -E "base64|defunct|syssls|system-check" ~/.bashrc ~/.profile ~/.zshrc 2>/dev/null && echo "  ✗ SUSPEITO!" || echo "  ✓ Limpo"

# Verificar arquivos executáveis em /tmp
echo -e "\n[4] Executáveis em diretórios temporários:"
find /tmp /var/tmp -type f -executable 2>/dev/null | wc -l | awk '{if($1>0) print "  ⚠ "$1" arquivos encontrados"; else print "  ✓ Limpo"}'

# Verificar uso de CPU
echo -e "\n[5] Uso de CPU:"
top -b -n 1 | head -3 | tail -1

# Verificar memória
echo -e "\n[6] Memória disponível:"
free -h | grep Mem

echo -e "\n=== VARREDURA CONCLUÍDA ==="
